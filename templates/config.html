<!-- Esempio per OpenAI, da replicare per gli altri provider -->
<div class="provider-section">
  <div class="provider-header">
    <div class="provider-icon">ðŸ¤–</div>
    <div class="provider-info">
      <h3>OpenAI</h3>
      <p>Modelli GPT per compiti generali e creativi</p>
    </div>
  </div>
  <div class="api-key-section">
    <h4>Chiave API OpenAI</h4>
    <div class="api-key-form">
      <input type="password" id="openai-key" class="api-key-input" placeholder="Inserisci la tua chiave API OpenAI">
      <button class="btn btn-primary" onclick="setApiKey('openai')">Salva</button>
      <button class="btn btn-secondary" onclick="testConnection('openai')">Test</button>
      {% if missing_keys.openai %}
      <a href="https://platform.openai.com/api-keys" target="_blank" style="margin-left:10px;color:#667eea;">Ottieni una chiave</a>
      {% endif %}
    </div>
    <div id="openai-test-result" class="test-result" style="display: none;"></div>
  </div>
  {% if not missing_keys.openai %}
  <div style="margin:20px 0;">
    <label for="openai-model-select"><b>Modello OpenAI:</b></label>
    <select id="openai-model-select" class="param-input" style="width:300px;"></select>
    <button class="btn btn-primary" onclick="saveSelectedModel('openai')">Seleziona</button>
  </div>
  {% endif %}
</div>
<!-- ... ripeti per Anthropic, Google, Locale ... -->
<script>
function populateModelSelect(provider) {
  fetch('/api/list_models', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ provider: provider })
  })
  .then(response => response.json())
  .then(data => {
    const select = document.getElementById(provider + '-model-select');
    if (!select) return;
    select.innerHTML = '';
    if (data.status === 'success' && data.models.length > 0) {
      data.models.forEach(model => {
        const option = document.createElement('option');
        option.value = model;
        option.textContent = model;
        select.appendChild(option);
      });
    } else {
      const option = document.createElement('option');
      option.value = '';
      option.textContent = 'Nessun modello disponibile';
      select.appendChild(option);
    }
  });
}
function saveSelectedModel(provider) {
  const select = document.getElementById(provider + '-model-select');
  const modelId = select.value;
  if (!modelId) return alert('Seleziona un modello valido');
  fetch('/api/set_model', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ model_id: modelId })
  })
  .then(response => response.json())
  .then(data => {
    if (data.status === 'success') {
      alert('Modello impostato con successo!');
      loadConfig();
    } else {
      alert('Errore: ' + data.message);
    }
  });
}
// Popola i menu modelli al caricamento
['openai','anthropic','google','local'].forEach(populateModelSelect);
</script> 